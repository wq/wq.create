language: python
python: 3.7
dist: xenial
env:
  global:
   - DJANGO="Django==2.2.5"
   - DRF="djangorestframework==3.10.3"
   - WQ_CORE="wq.core==1.2.0b1"
   - WQ_APP="wq.app==1.2.0b1"
   - WQ_DB="wq.db==1.2.0b1"
   - XLSCONV="xlsconv==1.1.0"
install:
 - pip install $DJANGO $DRF $XLSCONV
 - pip install $WQ_CORE $WQ_APP $WQ_DB
 - pip install .
addons:
  apt:
    packages:
      - libsqlite3-mod-spatialite
      - gdal-bin
matrix:
  include:
    - name: "Defaults (Python 3.7, SpatialLite, No NPM)"
    - name: "Python 3.6"
      python: 3.6
    - name: "Python 3.5"
      python: 3.5
    - name: "PostGIS"
      env:
        - POSTGRES=1
      addons:
        postgresql: "10"
        apt:
          packages:
           - postgresql-10-postgis-2.4
    - name: "NPM"
      env:
        - WITH_NPM=1
    - name: "Lint"
      env:
        - LINT=1
      install:
        - pip install flake8
script:
 - ./runtests.sh
